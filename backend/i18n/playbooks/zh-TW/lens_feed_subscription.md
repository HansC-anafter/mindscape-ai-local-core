---
playbook_code: lens_feed_subscription
version: 1.0.0
capability_code: walkto_lab
name: Lens Feed 訂閱
description: |
  訂閱 Lens Feed（$5/月），每週接收視角更新、每月接收 playbook 摘要，
  並可基於素材庫進行問答。跟隨一個世界觀持續演進。
tags:
  - walkto
  - subscription
  - lens
  - feed
  - weekly-updates

kind: user_workflow
interaction_mode:
  - conversational
  - needs_review
visible_in:
  - workspace_tools_panel
  - workspace_playbook_menu

required_tools:
  - cloud_capability.call

language_strategy: model_native
locale: zh-TW
supported_locales:
  - zh-TW
  - en
default_locale: en
auto_localize: true

entry_agent_type: coder
icon: 📰
---

# Lens Feed 訂閱 - SOP

## 目標

讓使用者訂閱並與 Lens Feed（$5/月）互動，提供：

1. **每週視角更新**：每週接收 3-7 條判斷句與觀察
2. **每月 Playbook 摘要**：接收每月視角與模式的摘要
3. **基於素材庫的問答**：基於創作者的素材庫提問（非通用 AI）

**核心價值**：
- 跟隨一個世界觀持續演進
- 以低成本探索創作者的視角
- 無需個人化承諾即可存取精選視角

**不保證**：
- 個人化（內容不會針對個別使用者客製）
- 完成度追蹤（不追蹤進度）
- 記憶（系統不會記住你的偏好）

## 執行步驟

### Phase 0: 訂閱設定

**執行順序**：
1. Step 0.0: 識別目標 Lens
2. Step 0.1: 檢查現有訂閱狀態
3. Step 0.2: 建立或啟用訂閱

#### Step 0.0: 識別目標 Lens

詢問使用者：
- 你想訂閱哪個創作者的 Lens？
- 你有特定的 lens_id 嗎？
- 或者你想瀏覽可用的 Lenses？

**輸出**：
- `lens_id`: 目標 Lens 識別碼
- `lens_name`: Lens 名稱（IP/創作者名稱）

#### Step 0.1: 檢查現有訂閱狀態

檢查使用者是否已有有效的 Lens Feed 訂閱：
- 查詢訂閱服務的 user_id 和 tier="lens_feed"
- 檢查訂閱是否有效且未過期

**輸出**：
- `has_active_subscription`: 布林值
- `existing_subscription`: 訂閱物件（如存在）
- `subscription_status`: "active" | "cancelled" | "expired" | "none"

#### Step 0.2: 建立或啟用訂閱

如果沒有有效訂閱：
1. 透過訂閱服務建立新訂閱
2. 設定 tier 為 "lens_feed"
3. 設定到期日為 30 天後
4. 處理付款（如需要）

如果訂閱存在但已過期：
1. 續訂訂閱
2. 更新到期日
3. 處理付款（如需要）

如果訂閱有效：
1. 確認訂閱有效
2. 進入 Phase 1

**輸出**：
- `subscription_id`: 訂閱識別碼
- `subscription_status`: "active"
- `expires_at`: 到期時間戳記

### Phase 1: 查看每週更新

**執行順序**：
1. Step 1.0: 取得最新每週更新
2. Step 1.1: 顯示更新內容
3. Step 1.2: 檢查更新歷史

#### Step 1.0: 取得最新每週更新

查詢 Lens Feed 服務的最新每週更新：
- 取得本週更新（週一 00:00 UTC）
- 如果本週沒有更新，取得最近一次更新
- 包含判斷句、觀察和可選素材

**輸出**：
- `weekly_update`: 每週更新物件
- `update_date`: 更新時間戳記
- `judgment_sentences`: 3-7 條判斷句列表
- `observations`: 觀察或故事列表
- `materials`: 可選照片、筆記或連結

#### Step 1.1: 顯示更新內容

向使用者呈現每週更新：
- 格式：判斷句 + 簡短觀察
- 包含可選素材（照片、筆記）
- 顯示更新日期和週數

**顯示格式**：
```
第 [N] 週更新 - [Lens 名稱]
日期：[YYYY-MM-DD]

視角：
1. [判斷句 1]
   [簡短觀察或故事]

2. [判斷句 2]
   [簡短觀察或故事]

...

素材：[照片/筆記連結（如有）]
```

**驗收標準**：
- ✅ 更新內容清晰顯示
- ✅ 判斷句已編號
- ✅ 觀察與判斷句配對
- ✅ 素材可存取（如有）

#### Step 1.2: 檢查更新歷史

如果使用者要求，顯示過去的每週更新：
- 列出過去 4 週的更新
- 允許使用者查看特定週的更新
- 顯示更新日期和週數

**輸出**：
- `update_history`: 過去每週更新列表
- `total_updates`: 可用更新總數

### Phase 2: 基於素材庫的問答

**執行順序**：
1. Step 2.0: 收集使用者問題
2. Step 2.1: 搜尋素材庫
3. Step 2.2: 基於素材生成答案

#### Step 2.0: 收集使用者問題

詢問使用者：
- 你想了解 [Lens 主題] 的什麼？
- 請具體說明你在找什麼
- 情境：你正在計劃參訪嗎？在找推薦嗎？

**輸出**：
- `user_question`: 使用者問題文字
- `question_context`: 可選的使用者情境

#### Step 2.1: 搜尋素材庫

搜尋創作者的素材庫以找到相關內容：
- 根據使用者問題的關鍵字搜尋
- 比對判斷句、觀察和素材
- 依相關性和新近度過濾

**搜尋邏輯**：
- 如有語義搜尋則使用
- 比對判斷句中的關鍵字
- 比對觀察故事中的關鍵字
- 優先考慮最近的素材

**輸出**：
- `relevant_materials`: 相關素材列表
- `matched_judgment_sentences`: 匹配的判斷句
- `matched_observations`: 匹配的觀察

#### Step 2.2: 基於素材生成答案

僅使用素材庫內容生成答案：
- 基於匹配的判斷句和觀察生成答案
- 不使用通用 AI 知識
- 如可能，引用特定素材
- 如果找不到相關素材，告知使用者

**答案格式**：
```
基於 [Lens 名稱] 的視角：

[基於判斷句和觀察的答案]

相關素材：
- [素材 1 參考]
- [素材 2 參考]

注意：此答案基於創作者的素材庫，非通用 AI 知識。
```

**驗收標準**：
- ✅ 答案僅基於素材庫
- ✅ 不使用通用 AI 知識
- ✅ 如可能，引用素材
- ✅ 如果找不到素材，告知使用者

### Phase 3: 每月 Playbook 摘要

**執行順序**：
1. Step 3.0: 檢查每月摘要是否可用
2. Step 3.1: 生成或取得每月摘要
3. Step 3.2: 顯示摘要

#### Step 3.0: 檢查每月摘要是否可用

檢查當月是否有每月摘要：
- 查詢當月摘要
- 如果不可用，檢查是否該生成（每月第一天）
- 如果還不到時間，告知使用者摘要何時可用

**輸出**：
- `summary_available`: 布林值
- `summary_date`: 摘要時間戳記
- `next_summary_date`: 下次摘要可用時間

#### Step 3.1: 生成或取得每月摘要

如果摘要存在：
- 取得現有每月摘要
- 包含模式、趨勢和關鍵視角

如果需要生成摘要：
- 彙總過去一個月的所有每週更新
- 識別模式和趨勢
- 提取關鍵視角
- 生成摘要文件

**摘要內容**：
- 當月視角概覽
- 觀察到的模式和趨勢
- 關鍵判斷句
- 值得注意的觀察或故事
- 素材亮點

**輸出**：
- `monthly_summary`: 每月摘要物件
- `summary_content`: 摘要文字
- `patterns`: 識別的模式列表
- `key_perspectives`: 關鍵視角列表

#### Step 3.2: 顯示摘要

向使用者呈現每月摘要：
- 格式化為可讀文件
- 包含模式和趨勢
- 突出關鍵視角
- 顯示素材亮點

**顯示格式**：
```
每月摘要 - [Lens 名稱]
月份：[YYYY-MM]

概覽：
[當月視角和模式摘要]

關鍵視角：
1. [視角 1]
2. [視角 2]
...

模式與趨勢：
- [模式 1]
- [模式 2]
...

素材亮點：
- [素材 1]
- [素材 2]
...
```

**驗收標準**：
- ✅ 摘要格式清晰
- ✅ 識別模式和趨勢
- ✅ 突出關鍵視角
- ✅ 包含素材亮點

### Phase 4: 訂閱管理

**執行順序**：
1. Step 4.0: 檢查訂閱狀態
2. Step 4.1: 處理續訂或取消
3. Step 4.2: 更新訂閱偏好

#### Step 4.0: 檢查訂閱狀態

查詢當前訂閱狀態：
- 檢查訂閱是否有效
- 檢查到期日
- 檢查付款狀態

**輸出**：
- `subscription_status`: "active" | "expiring_soon" | "expired" | "cancelled"
- `days_until_expiration`: 距離到期天數
- `payment_status`: 付款狀態

#### Step 4.1: 處理續訂或取消

如果使用者想續訂：
1. 處理付款（如需要）
2. 更新到期日
3. 確認續訂

如果使用者想取消：
1. 更新訂閱狀態為 "cancelled"
2. 確認取消
3. 告知使用者到期前仍可存取

**輸出**：
- `action_taken`: "renewed" | "cancelled" | "none"
- `new_expiration_date`: 更新的到期日（如續訂）

#### Step 4.2: 更新訂閱偏好

如果使用者想變更偏好：
- 更新通知偏好
- 更新交付偏好
- 儲存偏好

**輸出**：
- `preferences_updated`: 布林值
- `updated_preferences`: 更新的偏好物件

## 驗收標準

### 訂閱設定
- ✅ 使用者可以訂閱 Lens Feed
- ✅ 訂閱以正確 tier（"lens_feed"）建立
- ✅ 付款已處理（如需要）
- ✅ 訂閱到期日設定正確（30 天）

### 每週更新
- ✅ 使用者可以查看最新每週更新
- ✅ 更新包含 3-7 條判斷句
- ✅ 更新包含觀察或故事
- ✅ 使用者可以查看更新歷史

### 基於素材庫的問答
- ✅ 使用者可以提問
- ✅ 答案僅基於素材庫
- ✅ 不使用通用 AI 知識
- ✅ 如可能，引用素材

### 每月摘要
- ✅ 每月摘要於每月第一天可用
- ✅ 摘要包含模式和趨勢
- ✅ 摘要突出關鍵視角
- ✅ 摘要包含素材亮點

### 訂閱管理
- ✅ 使用者可以檢查訂閱狀態
- ✅ 使用者可以續訂訂閱
- ✅ 使用者可以取消訂閱
- ✅ 使用者可以更新偏好

## 錯誤處理

### 訂閱錯誤
- 如果訂閱建立失敗：告知使用者並重試
- 如果付款失敗：告知使用者並提供替代付款方式
- 如果訂閱已過期：提示使用者續訂

### 更新錯誤
- 如果沒有每週更新可用：告知使用者下次更新時間
- 如果更新取得失敗：重試並告知使用者

### 問答錯誤
- 如果找不到相關素材：告知使用者並建議替代問題
- 如果搜尋失敗：重試並告知使用者

### 摘要錯誤
- 如果摘要生成失敗：重試並告知使用者
- 如果摘要不可用：告知使用者何時可用

## 注意事項

- Lens Feed 是低成本入門點（$5/月）
- 內容不會針對個別使用者個人化
- 系統不追蹤使用者進度或偏好
- 重點在於跟隨世界觀的演進
- 每月摘要幫助使用者看到長期模式













