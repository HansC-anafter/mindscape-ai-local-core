{
  "version": "1.0",
  "playbook_code": "project_breakdown",
  "kind": "user_workflow",
  "steps": [
    {
      "id": "understand_project_overview",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "{{input.user_request}}\n\n{{input.context}}\n\nUnderstand project overview. Ask about project core goals and expected outcomes, understand project timeline and resource constraints, and identify key stakeholders and dependencies.",
        "schema_description": "A JSON object with the following properties: 1) project_goals: array of objects, each with goal (string), priority (string: 'high', 'medium', 'low'), and description (string). 2) expected_outcomes: array of objects, each with outcome (string), success_criteria (string), and importance (string). 3) timeline: object with start_date (string if available), end_date (string if available), duration (string), and constraints (array of strings). 4) resource_constraints: object with budget (string if available), team_size (string if available), skills_required (array of strings), and limitations (array of strings). 5) stakeholders: array of objects, each with stakeholder_name (string), role (string), involvement_level (string: 'high', 'medium', 'low'), and dependencies (array of strings)."
      },
      "outputs": {
        "project_goals": "extracted_data.project_goals",
        "expected_outcomes": "extracted_data.expected_outcomes",
        "timeline": "extracted_data.timeline",
        "resource_constraints": "extracted_data.resource_constraints",
        "stakeholders": "extracted_data.stakeholders"
      }
    },
    {
      "id": "divide_into_phases",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Project Goals: {{step.understand_project_overview.project_goals}}\n\nTimeline: {{step.understand_project_overview.timeline}}\n\nDivide into phases. Break down project into major phases, define clear deliverables for each phase, and identify dependencies between phases.",
        "schema_description": "A JSON object with the following properties: 1) project_phases: array of objects, each with phase_name (string), phase_number (integer), description (string), deliverables (array of objects, each with deliverable_name, description, and acceptance_criteria), duration (string), and dependencies (array of phase names or 'none'). 2) phase_dependencies: array of objects, each with phase1 (string), phase2 (string), dependency_type (string: 'sequential', 'parallel', 'conditional'), and description (string). 3) phase_sequence: array of phase names in execution order."
      },
      "outputs": {
        "project_phases": "extracted_data.project_phases",
        "phase_dependencies": "extracted_data.phase_dependencies",
        "phase_sequence": "extracted_data.phase_sequence"
      },
      "depends_on": ["understand_project_overview"]
    },
    {
      "id": "set_milestones",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Project Phases: {{step.divide_into_phases.project_phases}}\n\nTimeline: {{step.understand_project_overview.timeline}}\n\nSet milestones. Set key milestones for each phase, define acceptance criteria for milestones, and mark time points for each milestone.",
        "schema_description": "A JSON object with the following properties: 1) milestones: array of objects, each with milestone_name (string), phase (string), milestone_number (integer), description (string), acceptance_criteria (array of strings), target_date (string), and status (string: 'planned', 'in_progress', 'completed'). 2) milestone_sequence: array of milestone names in chronological order. 3) critical_milestones: array of milestone names that are critical for project success."
      },
      "outputs": {
        "milestones": "extracted_data.milestones",
        "milestone_sequence": "extracted_data.milestone_sequence",
        "critical_milestones": "extracted_data.critical_milestones"
      },
      "depends_on": ["divide_into_phases"]
    },
    {
      "id": "identify_risks",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Project Phases: {{step.divide_into_phases.project_phases}}\n\nResource Constraints: {{step.understand_project_overview.resource_constraints}}\n\nStakeholders: {{step.understand_project_overview.stakeholders}}\n\nIdentify risks. Identify potential risks for each phase, assess risk impact and probability, and provide risk mitigation suggestions.",
        "schema_description": "A JSON object with the following properties: 1) risks: array of objects, each with risk_name (string), phase (string), risk_type (string: 'technical', 'resource', 'schedule', 'scope', 'stakeholder', 'external'), description (string), impact (string: 'high', 'medium', 'low'), probability (string: 'high', 'medium', 'low'), and mitigation_strategy (string). 2) risk_matrix: object with high_impact_high_probability (array of risk names), high_impact_low_probability (array of risk names), low_impact_high_probability (array of risk names), and low_impact_low_probability (array of risk names). 3) mitigation_plan: array of objects, each with risk (string), mitigation_action (string), owner (string if available), and timeline (string)."
      },
      "outputs": {
        "risks": "extracted_data.risks",
        "risk_matrix": "extracted_data.risk_matrix",
        "mitigation_plan": "extracted_data.mitigation_plan"
      },
      "depends_on": ["set_milestones"]
    },
    {
      "id": "generate_next_actions",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Current Phase: {{input.current_phase}}\n\nProject Phases: {{step.divide_into_phases.project_phases}}\n\nMilestones: {{step.set_milestones.milestones}}\n\nRisks: {{step.identify_risks.risks}}\n\nGenerate next actions. Provide specific action recommendations for current phase, list tasks that need immediate attention, and provide resource and time estimates.",
        "schema_description": "A JSON object with the following properties: 1) immediate_actions: array of objects, each with action (string), priority (string: 'high', 'medium', 'low'), description (string), estimated_time (string), required_resources (array of strings), and dependencies (array of strings). 2) current_phase_tasks: array of objects, each with task (string), status (string: 'pending', 'in_progress', 'completed'), priority (string), estimated_time (string), and owner (string if available). 3) resource_estimates: object with human_resources (array of strings), time_estimates (object with task as key and time as value), and budget_considerations (array of strings). 4) next_steps: array of strings (immediate next steps to take)."
      },
      "outputs": {
        "immediate_actions": "extracted_data.immediate_actions",
        "current_phase_tasks": "extracted_data.current_phase_tasks",
        "resource_estimates": "extracted_data.resource_estimates",
        "next_steps": "extracted_data.next_steps"
      },
      "depends_on": ["identify_risks"]
    }
  ],
  "inputs": {
    "user_request": {
      "type": "string",
      "required": true,
      "description": "User's request for project breakdown"
    },
    "context": {
      "type": "string",
      "default": "",
      "description": "Additional context about the project"
    },
    "current_phase": {
      "type": "string",
      "default": "",
      "description": "Current project phase (if applicable)"
    }
  },
  "outputs": {
    "project_goals": {
      "type": "list[object]",
      "description": "Project goals and priorities",
      "source": "step.understand_project_overview.project_goals"
    },
    "expected_outcomes": {
      "type": "list[object]",
      "description": "Expected project outcomes",
      "source": "step.understand_project_overview.expected_outcomes"
    },
    "timeline": {
      "type": "object",
      "description": "Project timeline and constraints",
      "source": "step.understand_project_overview.timeline"
    },
    "resource_constraints": {
      "type": "object",
      "description": "Resource constraints",
      "source": "step.understand_project_overview.resource_constraints"
    },
    "stakeholders": {
      "type": "list[object]",
      "description": "Key stakeholders",
      "source": "step.understand_project_overview.stakeholders"
    },
    "project_phases": {
      "type": "list[object]",
      "description": "Project phases with deliverables",
      "source": "step.divide_into_phases.project_phases"
    },
    "phase_dependencies": {
      "type": "list[object]",
      "description": "Dependencies between phases",
      "source": "step.divide_into_phases.phase_dependencies"
    },
    "phase_sequence": {
      "type": "list[string]",
      "description": "Phase execution sequence",
      "source": "step.divide_into_phases.phase_sequence"
    },
    "milestones": {
      "type": "list[object]",
      "description": "Project milestones",
      "source": "step.set_milestones.milestones"
    },
    "milestone_sequence": {
      "type": "list[string]",
      "description": "Milestone sequence",
      "source": "step.set_milestones.milestone_sequence"
    },
    "critical_milestones": {
      "type": "list[string]",
      "description": "Critical milestones",
      "source": "step.set_milestones.critical_milestones"
    },
    "risks": {
      "type": "list[object]",
      "description": "Identified risks",
      "source": "step.identify_risks.risks"
    },
    "risk_matrix": {
      "type": "object",
      "description": "Risk matrix",
      "source": "step.identify_risks.risk_matrix"
    },
    "mitigation_plan": {
      "type": "list[object]",
      "description": "Risk mitigation plan",
      "source": "step.identify_risks.mitigation_plan"
    },
    "immediate_actions": {
      "type": "list[object]",
      "description": "Immediate action items",
      "source": "step.generate_next_actions.immediate_actions"
    },
    "current_phase_tasks": {
      "type": "list[object]",
      "description": "Current phase tasks",
      "source": "step.generate_next_actions.current_phase_tasks"
    },
    "resource_estimates": {
      "type": "object",
      "description": "Resource and time estimates",
      "source": "step.generate_next_actions.resource_estimates"
    },
    "next_steps": {
      "type": "list[string]",
      "description": "Next steps to take",
      "source": "step.generate_next_actions.next_steps"
    }
  }
}

