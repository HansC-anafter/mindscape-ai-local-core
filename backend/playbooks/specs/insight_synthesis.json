{
  "version": "1.0",
  "playbook_code": "insight_synthesis",
  "kind": "user_workflow",
  "steps": [
    {
      "id": "synthesize_data_sources",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "{{input.user_request}}\n\n{{input.context}}\n\n{{input.data_sources}}\n\nSynthesize multiple data sources. Collect data from multiple sources (analysis reports, metrics, trends), integrate findings from different data sets, identify connections and relationships between data sources, resolve contradictions or conflicting information, and build comprehensive data picture.",
        "schema_description": "A JSON object with the following properties: 1) data_sources: array of objects, each with source_name (string), source_type (string), key_findings (array of strings), and reliability (string: 'high', 'medium', 'low'). 2) integrated_findings: object with common_themes (array of strings), connections (array of objects with source1, source2, and relationship), and contradictions (array of objects with contradiction and resolution). 3) comprehensive_picture: string (overall synthesis of all data sources)."
      },
      "outputs": {
        "data_sources": "extracted_data.data_sources",
        "integrated_findings": "extracted_data.integrated_findings",
        "comprehensive_picture": "extracted_data.comprehensive_picture"
      }
    },
    {
      "id": "identify_key_insights",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Integrated Findings: {{step.synthesize_data_sources.integrated_findings}}\n\nComprehensive Picture: {{step.synthesize_data_sources.comprehensive_picture}}\n\nIdentify key insights. Analyze synthesized data to identify key insights, extract actionable findings and observations, identify patterns and trends across sources, recognize opportunities and risks, and highlight critical business implications.",
        "schema_description": "A JSON object with the following properties: 1) key_insights: array of objects, each with insight (string), category (string: 'opportunity', 'risk', 'trend', 'pattern'), description (string), significance (string: 'high', 'medium', 'low'), and supporting_evidence (array of strings). 2) patterns_and_trends: array of objects, each with pattern (string), description (string), and implications (string). 3) opportunities: array of objects, each with opportunity (string), description (string), and potential_value (string). 4) risks: array of objects, each with risk (string), description (string), and severity (string: 'high', 'medium', 'low')."
      },
      "outputs": {
        "key_insights": "extracted_data.key_insights",
        "patterns_and_trends": "extracted_data.patterns_and_trends",
        "opportunities": "extracted_data.opportunities",
        "risks": "extracted_data.risks"
      },
      "depends_on": ["synthesize_data_sources"]
    },
    {
      "id": "link_business_impact",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Key Insights: {{step.identify_key_insights.key_insights}}\n\nOpportunities: {{step.identify_key_insights.opportunities}}\n\nRisks: {{step.identify_key_insights.risks}}\n\nLink business impact. Connect insights to business objectives and goals, assess impact on key business metrics, evaluate potential business value or risk, identify affected business areas or processes, and quantify potential impact where possible.",
        "schema_description": "A JSON object with the following properties: 1) business_impact: array of objects, each with insight (string), business_objective (string), impact_level (string: 'high', 'medium', 'low'), affected_metrics (array of strings), and quantified_impact (string if available). 2) business_value: array of objects, each with opportunity (string), potential_value (string), implementation_effort (string: 'high', 'medium', 'low'), and roi_estimate (string if available). 3) business_risks: array of objects, each with risk (string), affected_areas (array of strings), potential_loss (string), and mitigation_priority (string: 'high', 'medium', 'low')."
      },
      "outputs": {
        "business_impact": "extracted_data.business_impact",
        "business_value": "extracted_data.business_value",
        "business_risks": "extracted_data.business_risks"
      },
      "depends_on": ["identify_key_insights"]
    },
    {
      "id": "generate_action_recommendations",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Business Impact: {{step.link_business_impact.business_impact}}\n\nBusiness Value: {{step.link_business_impact.business_value}}\n\nBusiness Risks: {{step.link_business_impact.business_risks}}\n\nGenerate action recommendations. Create prioritized action recommendations, link recommendations to specific insights, provide implementation guidance, estimate effort and expected outcomes, and create action plan with timelines.",
        "schema_description": "A JSON object with the following properties: 1) action_recommendations: array of objects, each with recommendation (string), linked_insight (string), priority (string: 'high', 'medium', 'low'), implementation_guidance (string), effort_estimate (string: 'high', 'medium', 'low'), expected_outcome (string), and timeline (string). 2) action_plan: object with immediate_actions (array of action objects), short_term_actions (array of action objects), and long_term_actions (array of action objects). 3) implementation_roadmap: array of objects, each with phase (string), actions (array of strings), timeline (string), and dependencies (array of strings)."
      },
      "outputs": {
        "action_recommendations": "extracted_data.action_recommendations",
        "action_plan": "extracted_data.action_plan",
        "implementation_roadmap": "extracted_data.implementation_roadmap"
      },
      "depends_on": ["link_business_impact"]
    },
    {
      "id": "generate_insight_report",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Key Insights: {{step.identify_key_insights.key_insights}}\n\nBusiness Impact: {{step.link_business_impact.business_impact}}\n\nAction Recommendations: {{step.generate_action_recommendations.action_recommendations}}\n\nImplementation Roadmap: {{step.generate_action_recommendations.implementation_roadmap}}\n\nGenerate insight report. Compile all synthesis findings and create comprehensive insight report with executive summary, data synthesis overview, key insights and findings, business impact analysis, action recommendations and priorities, and implementation roadmap.",
        "schema_description": "A JSON object with the following properties: 1) executive_summary: string (key findings and recommendations). 2) data_synthesis_overview: object with data_sources_summary (string), integrated_findings_summary (string), and comprehensive_picture (string). 3) key_insights_summary: object with insights (array of insight objects), patterns_and_trends (array of pattern objects), and critical_implications (array of strings). 4) business_impact_analysis: object with impact_summary (string), value_opportunities (array of opportunity objects), and risk_assessment (array of risk objects). 5) action_recommendations_summary: object with prioritized_recommendations (array of recommendation objects), action_plan (object), and implementation_roadmap (array of phase objects)."
      },
      "outputs": {
        "executive_summary": "extracted_data.executive_summary",
        "data_synthesis_overview": "extracted_data.data_synthesis_overview",
        "key_insights_summary": "extracted_data.key_insights_summary",
        "business_impact_analysis": "extracted_data.business_impact_analysis",
        "action_recommendations_summary": "extracted_data.action_recommendations_summary"
      },
      "depends_on": ["generate_action_recommendations"]
    }
  ],
  "inputs": {
    "user_request": {
      "type": "string",
      "required": true,
      "description": "User's request for insight synthesis"
    },
    "context": {
      "type": "string",
      "default": "",
      "description": "Additional context about the business or situation"
    },
    "data_sources": {
      "type": "string",
      "default": "",
      "description": "Data sources to synthesize (analysis reports, metrics, trends)"
    }
  },
  "outputs": {
    "data_sources": {
      "type": "list[object]",
      "description": "Synthesized data sources",
      "source": "step.synthesize_data_sources.data_sources"
    },
    "integrated_findings": {
      "type": "object",
      "description": "Integrated findings from multiple sources",
      "source": "step.synthesize_data_sources.integrated_findings"
    },
    "comprehensive_picture": {
      "type": "string",
      "description": "Comprehensive data picture",
      "source": "step.synthesize_data_sources.comprehensive_picture"
    },
    "key_insights": {
      "type": "list[object]",
      "description": "Key insights identified",
      "source": "step.identify_key_insights.key_insights"
    },
    "patterns_and_trends": {
      "type": "list[object]",
      "description": "Patterns and trends across sources",
      "source": "step.identify_key_insights.patterns_and_trends"
    },
    "opportunities": {
      "type": "list[object]",
      "description": "Identified opportunities",
      "source": "step.identify_key_insights.opportunities"
    },
    "risks": {
      "type": "list[object]",
      "description": "Identified risks",
      "source": "step.identify_key_insights.risks"
    },
    "business_impact": {
      "type": "list[object]",
      "description": "Business impact analysis",
      "source": "step.link_business_impact.business_impact"
    },
    "business_value": {
      "type": "list[object]",
      "description": "Business value opportunities",
      "source": "step.link_business_impact.business_value"
    },
    "business_risks": {
      "type": "list[object]",
      "description": "Business risks assessment",
      "source": "step.link_business_impact.business_risks"
    },
    "action_recommendations": {
      "type": "list[object]",
      "description": "Prioritized action recommendations",
      "source": "step.generate_action_recommendations.action_recommendations"
    },
    "action_plan": {
      "type": "object",
      "description": "Action plan with timelines",
      "source": "step.generate_action_recommendations.action_plan"
    },
    "implementation_roadmap": {
      "type": "list[object]",
      "description": "Implementation roadmap",
      "source": "step.generate_action_recommendations.implementation_roadmap"
    },
    "executive_summary": {
      "type": "string",
      "description": "Executive summary of insight report",
      "source": "step.generate_insight_report.executive_summary"
    },
    "data_synthesis_overview": {
      "type": "object",
      "description": "Data synthesis overview",
      "source": "step.generate_insight_report.data_synthesis_overview"
    },
    "key_insights_summary": {
      "type": "object",
      "description": "Key insights summary",
      "source": "step.generate_insight_report.key_insights_summary"
    },
    "business_impact_analysis": {
      "type": "object",
      "description": "Business impact analysis",
      "source": "step.generate_insight_report.business_impact_analysis"
    },
    "action_recommendations_summary": {
      "type": "object",
      "description": "Action recommendations summary",
      "source": "step.generate_insight_report.action_recommendations_summary"
    }
  }
}

