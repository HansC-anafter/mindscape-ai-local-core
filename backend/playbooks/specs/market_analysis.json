{
  "version": "1.0",
  "playbook_code": "market_analysis",
  "kind": "user_workflow",
  "steps": [
    {
      "id": "collect_market_data",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "{{input.user_request}}\n\n{{input.context}}\n\nCollect market data. Gather market research and industry reports, collect market size and growth data, obtain customer demographics and behavior data, collect industry trends and forecasts, and gather regulatory and policy information.",
        "schema_description": "A JSON object with the following properties: 1) market_size: object with current_size (string), growth_rate (string), and projections (array of objects with year and size). 2) customer_data: object with demographics (object with key-value pairs), behavior_patterns (array of strings), and preferences (array of strings). 3) industry_trends: array of objects, each with trend_name (string), description (string), impact (string: 'high', 'medium', 'low'), and timeframe (string). 4) regulatory_info: array of objects, each with regulation (string), description (string), and impact (string)."
      },
      "outputs": {
        "market_size": "extracted_data.market_size",
        "customer_data": "extracted_data.customer_data",
        "industry_trends": "extracted_data.industry_trends",
        "regulatory_info": "extracted_data.regulatory_info"
      }
    },
    {
      "id": "analyze_competitors",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Market Data: {{step.collect_market_data.market_size}}\n\nCustomer Data: {{step.collect_market_data.customer_data}}\n\nAnalyze competitors. Identify key competitors and market players, analyze competitor products and services, assess competitor strengths and weaknesses, evaluate competitor positioning and strategies, and compare pricing and business models.",
        "schema_description": "A JSON object with the following properties: 1) competitors: array of objects, each with competitor_name (string), products_services (array of strings), strengths (array of strings), weaknesses (array of strings), positioning (string), strategy (string), pricing_model (string), and market_share (string). 2) competitive_landscape: object with market_leaders (array of competitor names), emerging_players (array of competitor names), and competitive_intensity (string: 'high', 'medium', 'low'). 3) competitive_analysis: object with key_differentiators (array of strings), competitive_advantages (array of strings), and threats (array of strings)."
      },
      "outputs": {
        "competitors": "extracted_data.competitors",
        "competitive_landscape": "extracted_data.competitive_landscape",
        "competitive_analysis": "extracted_data.competitive_analysis"
      },
      "depends_on": ["collect_market_data"]
    },
    {
      "id": "identify_market_trends",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Industry Trends: {{step.collect_market_data.industry_trends}}\n\nCompetitive Landscape: {{step.analyze_competitors.competitive_landscape}}\n\nIdentify market trends. Analyze industry trends and patterns, identify emerging technologies and innovations, recognize changing customer preferences, assess market dynamics and shifts, and evaluate trend impact and implications.",
        "schema_description": "A JSON object with the following properties: 1) market_trends: array of objects, each with trend_name (string), category (string: 'technology', 'consumer_behavior', 'market_structure', 'regulatory'), description (string), impact_level (string: 'high', 'medium', 'low'), timeframe (string), and implications (array of strings). 2) emerging_technologies: array of objects, each with technology (string), description (string), potential_impact (string), and adoption_timeline (string). 3) customer_preference_shifts: array of objects, each with shift (string), description (string), and impact (string)."
      },
      "outputs": {
        "market_trends": "extracted_data.market_trends",
        "emerging_technologies": "extracted_data.emerging_technologies",
        "customer_preference_shifts": "extracted_data.customer_preference_shifts"
      },
      "depends_on": ["analyze_competitors"]
    },
    {
      "id": "evaluate_opportunities_risks",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Market Trends: {{step.identify_market_trends.market_trends}}\n\nCompetitive Analysis: {{step.analyze_competitors.competitive_analysis}}\n\nEvaluate opportunities and risks. Identify market opportunities and gaps, assess market entry barriers, evaluate competitive advantages, recognize potential risks and threats, and quantify opportunity size and potential.",
        "schema_description": "A JSON object with the following properties: 1) market_opportunities: array of objects, each with opportunity (string), description (string), market_size (string), potential_value (string: 'high', 'medium', 'low'), barriers (array of strings), and feasibility (string: 'high', 'medium', 'low'). 2) market_gaps: array of objects, each with gap (string), description (string), and potential (string). 3) risks_and_threats: array of objects, each with risk (string), description (string), likelihood (string: 'high', 'medium', 'low'), impact (string: 'high', 'medium', 'low'), and mitigation (string). 4) competitive_advantages: array of objects, each with advantage (string), description (string), and sustainability (string: 'high', 'medium', 'low')."
      },
      "outputs": {
        "market_opportunities": "extracted_data.market_opportunities",
        "market_gaps": "extracted_data.market_gaps",
        "risks_and_threats": "extracted_data.risks_and_threats",
        "competitive_advantages": "extracted_data.competitive_advantages"
      },
      "depends_on": ["identify_market_trends"]
    },
    {
      "id": "generate_market_report",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Market Data: {{step.collect_market_data.market_size}}\n\nCompetitors: {{step.analyze_competitors.competitors}}\n\nMarket Trends: {{step.identify_market_trends.market_trends}}\n\nOpportunities: {{step.evaluate_opportunities_risks.market_opportunities}}\n\nRisks: {{step.evaluate_opportunities_risks.risks_and_threats}}\n\nGenerate market analysis report. Compile all analysis findings and create comprehensive market analysis report with executive summary, market overview and size, competitive landscape analysis, market trends and dynamics, opportunities and risks assessment, and strategic recommendations.",
        "schema_description": "A JSON object with the following properties: 1) executive_summary: string (key findings and recommendations). 2) market_overview: object with market_size (object), growth_prospects (string), and key_characteristics (array of strings). 3) competitive_landscape_summary: object with key_players (array of strings), market_structure (string), and competitive_dynamics (string). 4) trends_summary: object with key_trends (array of strings), emerging_technologies (array of strings), and implications (string). 5) opportunities_assessment: object with top_opportunities (array of objects), market_gaps (array of strings), and potential_value (string). 6) risks_assessment: object with key_risks (array of objects), threats (array of strings), and mitigation_strategies (array of strings). 7) strategic_recommendations: array of objects, each with recommendation (string), rationale (string), priority (string: 'high', 'medium', 'low'), and expected_impact (string)."
      },
      "outputs": {
        "executive_summary": "extracted_data.executive_summary",
        "market_overview": "extracted_data.market_overview",
        "competitive_landscape_summary": "extracted_data.competitive_landscape_summary",
        "trends_summary": "extracted_data.trends_summary",
        "opportunities_assessment": "extracted_data.opportunities_assessment",
        "risks_assessment": "extracted_data.risks_assessment",
        "strategic_recommendations": "extracted_data.strategic_recommendations"
      },
      "depends_on": ["evaluate_opportunities_risks"]
    }
  ],
  "inputs": {
    "user_request": {
      "type": "string",
      "required": true,
      "description": "User's request for market analysis"
    },
    "context": {
      "type": "string",
      "default": "",
      "description": "Additional context about the market or industry"
    }
  },
  "outputs": {
    "market_size": {
      "type": "object",
      "description": "Market size and growth data",
      "source": "step.collect_market_data.market_size"
    },
    "customer_data": {
      "type": "object",
      "description": "Customer demographics and behavior data",
      "source": "step.collect_market_data.customer_data"
    },
    "industry_trends": {
      "type": "list[object]",
      "description": "Industry trends and forecasts",
      "source": "step.collect_market_data.industry_trends"
    },
    "regulatory_info": {
      "type": "list[object]",
      "description": "Regulatory and policy information",
      "source": "step.collect_market_data.regulatory_info"
    },
    "competitors": {
      "type": "list[object]",
      "description": "Competitor analysis",
      "source": "step.analyze_competitors.competitors"
    },
    "competitive_landscape": {
      "type": "object",
      "description": "Competitive landscape overview",
      "source": "step.analyze_competitors.competitive_landscape"
    },
    "competitive_analysis": {
      "type": "object",
      "description": "Detailed competitive analysis",
      "source": "step.analyze_competitors.competitive_analysis"
    },
    "market_trends": {
      "type": "list[object]",
      "description": "Market trends and patterns",
      "source": "step.identify_market_trends.market_trends"
    },
    "emerging_technologies": {
      "type": "list[object]",
      "description": "Emerging technologies and innovations",
      "source": "step.identify_market_trends.emerging_technologies"
    },
    "customer_preference_shifts": {
      "type": "list[object]",
      "description": "Changing customer preferences",
      "source": "step.identify_market_trends.customer_preference_shifts"
    },
    "market_opportunities": {
      "type": "list[object]",
      "description": "Market opportunities and gaps",
      "source": "step.evaluate_opportunities_risks.market_opportunities"
    },
    "market_gaps": {
      "type": "list[object]",
      "description": "Identified market gaps",
      "source": "step.evaluate_opportunities_risks.market_gaps"
    },
    "risks_and_threats": {
      "type": "list[object]",
      "description": "Risks and threats assessment",
      "source": "step.evaluate_opportunities_risks.risks_and_threats"
    },
    "competitive_advantages": {
      "type": "list[object]",
      "description": "Competitive advantages",
      "source": "step.evaluate_opportunities_risks.competitive_advantages"
    },
    "executive_summary": {
      "type": "string",
      "description": "Executive summary of market analysis",
      "source": "step.generate_market_report.executive_summary"
    },
    "market_overview": {
      "type": "object",
      "description": "Market overview and size",
      "source": "step.generate_market_report.market_overview"
    },
    "competitive_landscape_summary": {
      "type": "object",
      "description": "Competitive landscape summary",
      "source": "step.generate_market_report.competitive_landscape_summary"
    },
    "trends_summary": {
      "type": "object",
      "description": "Market trends summary",
      "source": "step.generate_market_report.trends_summary"
    },
    "opportunities_assessment": {
      "type": "object",
      "description": "Opportunities assessment",
      "source": "step.generate_market_report.opportunities_assessment"
    },
    "risks_assessment": {
      "type": "object",
      "description": "Risks assessment",
      "source": "step.generate_market_report.risks_assessment"
    },
    "strategic_recommendations": {
      "type": "list[object]",
      "description": "Strategic recommendations",
      "source": "step.generate_market_report.strategic_recommendations"
    }
  }
}

