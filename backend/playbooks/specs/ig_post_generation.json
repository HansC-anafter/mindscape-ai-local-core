{
  "version": "1.0",
  "playbook_code": "ig_post_generation",
  "kind": "user_workflow",
  "steps": [
    {
      "id": "extract_topics",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "{{input.source_content}}",
        "schema_description": "A JSON object with a 'topics' property: array of strings (key topics extracted from the content for Instagram post generation)."
      },
      "outputs": {
        "topics": "extracted_data.topics"
      }
    },
    {
      "id": "generate_posts",
      "tool": "core_llm.structured_extract",
      "inputs": {
        "text": "Source content: {{input.source_content}}\n\nExtracted topics: {{step.extract_topics.topics}}\n\nGenerate {{input.post_count}} Instagram posts based on the topics above.",
        "schema_description": "A JSON object with an 'ig_posts' property: array of objects, each with 'text' (string, the post content) and 'hashtags' (array of strings, relevant hashtags for the post)."
      },
      "outputs": {
        "ig_posts": "extracted_data.ig_posts"
      },
      "depends_on": ["extract_topics"]
    }
  ],
  "inputs": {
    "source_content": {
      "type": "string",
      "required": true,
      "description": "Source content to generate posts from"
    },
    "post_count": {
      "type": "integer",
      "default": 5,
      "description": "Number of posts to generate"
    }
  },
  "outputs": {
    "ig_posts": {
      "type": "list[object]",
      "description": "Generated IG posts list",
      "source": "step.generate_posts.ig_posts"
    },
    "topics": {
      "type": "list[string]",
      "description": "Extracted key topics",
      "source": "step.extract_topics.topics"
    }
  },
  "output_artifacts": [
    {
      "id": "instagram_posts",
      "artifact_type": "post",
      "primary_action_type": "copy",
      "title_template": "Instagram 貼文 - {{input.post_count}} 篇",
      "summary_template": "基於「{{input.source_content}}」生成的 {{input.post_count}} 篇 Instagram 貼文",
      "source": "step.generate_posts.ig_posts",
      "file_write": {
        "enabled": true,
        "file_name_template": "ig_posts.json",
        "encoding": "utf-8"
      },
      "metadata": {
        "platform": "instagram",
        "post_count": "{{input.post_count}}",
        "navigate_to": "{{execution_id}}",
        "navigate_type": "execution"
      }
    }
  ]
}

